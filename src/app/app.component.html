<div class="flex-row margin-row">
	<form class="flex-1" onsubmit="return false">
		<div class="date-wrapper">
			<!-- date picker -->
			<app-date-range-picker [formControl]="dateRangeFormControl"></app-date-range-picker>

			<span>or</span>

			<!-- date dropdown -->
			<app-date-range-dropdown appDateRangeDropdown [formControl]="dateRangeFormControl"></app-date-range-dropdown>
			<!-- <div class="date-wrapper-dropdown">
				<div><strong>Downloads</strong> in past</div>
				<mat-form-field appearance="fill">
					<mat-label>Select date range</mat-label>
					<mat-select appDateRangeDropdown [formControl]="dateRangeFormControl">
						<mat-option *ngFor="let date of DATE_RANGE_DROPDOWN_DATA" [value]="date"> {{date.name}} </mat-option>
					</mat-select>
				</mat-form-field>
			</div> -->
		</div>
	</form>

	<div>
		<button class="clear-cache-button" mat-stroked-button (click)="clearCache()">Clear cache</button>
	</div>
</div>

<ng-container *ngIf="chartData$ | async as chartData">
	<div class="margin-row" *ngIf="chartData.columns.length > 1">
		<div class="container">
			<app-chart [chartData]="chartData"></app-chart>
		</div>
	</div>
</ng-container>

<div class="margin-row">
	<div class="container">
		<form #addPackageNameForm onsubmit="return false">
			<mat-form-field appearance="outline">
				<mat-label>npm package name</mat-label>
				<input matInput [formControl]="addPackage" [matAutocomplete]="auto" />
				<mat-hint>Ex: 'canjs'</mat-hint>
				<mat-error appErrorHandler [errors$]="addPackage.errors | toObservable" [handleErrors]="packageErrorsHandler">
				</mat-error>

				<mat-autocomplete #auto="matAutocomplete">
					<mat-option *ngFor="let option of autocompleteOptions$ | async" [value]="option"> {{ option }} </mat-option>
				</mat-autocomplete>
			</mat-form-field>

			<button mat-raised-button color="primary" [disabled]="!addPackage.value || addPackage.invalid">Add</button>
		</form>

		<!-- list of selected libraries -->
		<app-package-list
			(removePackageName)="removePackageName($event)"
			[registryData]="apiDatas$ | async"
			[formControl]="selectedPackageNames"
		></app-package-list>
	</div>
</div>

<!-- footer -->
<footer></footer>

<ng-template #noPackageNames>
	<p>Add npm packages using the input above. Then you can view download analytics over time.</p>
</ng-template>
